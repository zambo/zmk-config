parse_config:
  zmk_additional_includes:
    - "modules/zmk/helpers/include"

  zmk_preamble: |
    #include <zmk-helpers/key-labels/eyelash42.h>
    #define CONFIG_WIRELESS

  mark_alternate_layer_activators: true
  sticky_label: $$mdi:gesture-tap-hold$$
  trans_legend:
    tap: $$mdi:circle-medium$$
    type: trans

  raw_binding_map:
    # System commands
    "&bootloader":
      tap: $$mdi:progress-download$$
      type: bootloader
    "&sys_reset":
      tap: $$mdi:backup-restore$$
      type: bootloader

    # Bluetooth with numeric legends - bluetooth icon + number with tighter spacing
    "&bt BT_SEL 0":
      tap: $$mdi:bluetooth-connect$$
      hold: "1"
    "&bt BT_SEL 1":
      tap: $$mdi:bluetooth-connect$$
      hold: "2"
    "&bt BT_SEL 2":
      tap: $$mdi:bluetooth-connect$$
      hold: "3"
    "&bt BT_SEL 3":
      tap: $$mdi:bluetooth-connect$$
      hold: "4"
    "&bt BT_CLR": $$mdi:bluetooth-off$$

    # Custom behaviors
    "&copy_cut": $$mdi:content-copy$$
    "&swapper": $$mdi:swap-horizontal$$
    "&select_word": $$mdi:select-all$$
    "&select_line": $$mdi:format-line-height$$

    # Navigation combos
    "&kp LG(LS(LBKT))": $$mdi:tab-minus$$     # Previous tab
    "&kp LG(LS(RBKT))": $$mdi:tab-plus$$      # Next tab
    "&kp LG(LBKT)": $$mdi:arrow-left$$        # Navigate back
    "&kp LG(RBKT)": $$mdi:arrow-right$$       # Navigate forward

    # Emoji picker
    "&emoji_picker_macro": "ðŸ˜Š"

    # Layer switching
    "&to 0": $$mdi:keyboard-esc$$  # Go to base layer (ESC on PAD layer)
    
    # Tab combos - specific behaviors
    "&kp TAB": $$mdi:keyboard-tab$$        # Regular tab (left combo)
    "&kp LS(TAB)": $$mdi:keyboard-tab-reverse$$ # Shift+Tab/reverse tab (right combo)
    
    # Combo-specific mappings
    "l_tab": $$mdi:keyboard-tab$$          # Left tab combo name
    "r_tab": $$mdi:tab-unselected$$       # Right tab combo name
    
    # Homerow modifier aliases
    HMR_0: $$mdi:star-four-points$$ # Hyper key
    "&comma_morph":
      tap: ","
      shifted: ";"
    "&dot_morph":
      tap: "."
      shifted: ":"
    "&qexcl":
      tap: "?"
      shifted: "!"

    # Layer management
    "&magic_shift":
      tap: Magic
      hold: $$mdi:apple-keyboard-shift$$
      shifted: $$mdi:alpha-w-box$$
    "&caps_word": $$mdi:alpha-w-box$$

    # Media controls
    "&kp C_MUTE": $$mdi:volume-off$$
    "&kp C_VOL_UP": $$mdi:volume-high$$
    "&kp C_VOL_DN": $$mdi:volume-low$$
    "&kp C_NEXT": $$mdi:skip-next$$
    "&kp C_PREV": $$mdi:skip-previous$$
    "&kp C_PP": $$mdi:play-pause$$

    # Power and brightness
    "&kp C_POWER": $$mdi:power-standby$$
    "&kp C_BRI_UP": $$mdi:brightness-5$$
    "&kp C_BRI_DN": $$mdi:brightness-7$$

    # Special combo keys
    "&dot_spc":
      tap: "."
      shifted: "Sentence"
    "&num_dance":
      tap: "Numword"
      shifted: "Sticky Num"

    # RGB Underglow controls
    "&rgb_ug RGB_TOG": $$mdi:lightbulb$$
    "&rgb_ug RGB_BRI": $$mdi:brightness-6$$
    "&rgb_ug RGB_BRD": $$mdi:brightness-4$$
    "&rgb_ug RGB_HUI": $$mdi:palette$$
    "&rgb_ug RGB_HUD": $$mdi:palette-outline$$
    "&rgb_ug RGB_SAI": $$mdi:water-plus$$
    "&rgb_ug RGB_SAD": $$mdi:water-minus$$
    "&rgb_ug RGB_SPI": $$mdi:speedometer$$
    "&rgb_ug RGB_SPD": $$mdi:speedometer-slow$$
    "&rgb_ug RGB_EFF": $$mdi:creation$$

    # Numpad key bindings - cleaner display
    "&kp KP_N0": "0"
    "&kp KP_N1": "1"
    "&kp KP_N2": "2"
    "&kp KP_N3": "3"
    "&kp KP_N4": "4"
    "&kp KP_N5": "5"
    "&kp KP_N6": "6"
    "&kp KP_N7": "7"
    "&kp KP_N8": "8"
    "&kp KP_N9": "9"
    "&kp KP_DOT": "."
    "&kp KP_PLUS": "+"
    "&kp KP_MINUS": "-"
    "&kp KP_MULTIPLY": "Ã—"
    "&kp KP_DIVIDE": "Ã·"
    "&kp KP_EQUAL": "="
    "&kp KP_ENTER": $$mdi:keyboard-return$$
    "&kp KP_COMMA": ","

    # Standard number keys
    "&kp N0": "0"
    "&kp N1": "1"
    "&kp N2": "2"
    "&kp N3": "3"
    "&kp N4": "4"
    "&kp N5": "5"
    "&kp N6": "6"
    "&kp N7": "7"
    "&kp N8": "8"
    "&kp N9": "9"

    # Combo symbol mappings - display actual symbols instead of descriptive names
    "&kp AMPS": "&" # Ampersand
    "&kp PERCENT": "%" # Percent
    "&kp UNDER": "_" # Underscore
    "&kp BSLH": '\' # Backslash
    "&kp PIPE": "|" # Pipe
    "&kp QUOT": '"' # Quote
    "&kp EQL": "=" # Equals
    "&kp FSLH": "/" # Forward slash
    "&kp AT": "@" # At symbol
    "&kp GRAVE": "`" # Grave
    "&kp LT": "<" # Less than
    "&kp GT": ">" # Greater than
    "&kp CARET": "^" # Caret
    "&kp DLLR": "$" # Dollar
    "&kp MINUS": "-" # Minus/Dash
    "&kp PLUS": "+" # Plus
    "&kp LBRC": "{" # Left brace
    "&kp RBRC": "}" # Right brace
    "&kp LPAR": "(" # Left parenthesis
    "&kp RPAR": ")" # Right parenthesis
    "&kp LBKT": "[" # Left bracket
    "&kp RBKT": "]" # Right bracket
    "&kp STAR": "*" # Star/Asterisk
    "&kp HASH": "#" # Hash
    "&kp TILDE": "~" # Tilde
    "&kp COLON": ":" # Colon
    "&kp EXCL": "!" # Exclamation
    "&kp SEMI": ";" # Semicolon

    # Quote symbols
    "&kp SQT": "'" # Single quote
    SQT: "'" # Single quote keycode

    # CANCEL macro mapping
    CANCEL: $$mdi:close-circle$$

    # Additional key mappings
    "&kp RET": $$mdi:keyboard-return$$
    RET: $$mdi:keyboard-return$$
    "&kp LGUI": $$mdi:apple-keyboard-command$$
    "&kp RGUI": $$mdi:apple-keyboard-command$$
    GUI: $$mdi:apple-keyboard-command$$
    "&kp KP_SLASH": "Ã·"
    "&kp KP_FSLH": "Ã·"
    "KP SLASH": "Ã·"

    # Mouse movement controls - using directional arrow icons like nav layer
    "&mmv MOVE_UP": $$mdi:arrow-up-bold-circle$$
    "&mmv MOVE_DOWN": $$mdi:arrow-down-bold-circle$$
    "&mmv MOVE_LEFT": $$mdi:arrow-left-bold-circle$$
    "&mmv MOVE_RIGHT": $$mdi:arrow-right-bold-circle$$

    # Mouse scroll controls - using mouse-move icons
    "&msc SCRL_UP": $$mdi:mouse-move-up$$
    "&msc SCRL_DOWN": $$mdi:mouse-move-down$$
    "&msc SCRL_LEFT": $$mdi:mouse-move-vertical$$
    "&msc SCRL_RIGHT": $$mdi:mouse-move-vertical$$

    # Mouse click controls - specific click icons
    "&mkp LCLK": $$mdi:mouse-left-click$$
    "&mkp RCLK": $$mdi:mouse-right-click$$
    "&mkp MCLK": $$mdi:mouse-scroll-wheel$$

    # Macro wrapper for layer tap with key repeat
    "&mcr_repeat":
      tap: $$mdi:repeat$$
      hold: Macro

    # Smart number behavior
    "&smart_num":
      tap: $$mdi:pin$$
      hold: Num
      shifted: $$mdi:numeric$$

    # Math and special symbols for numpad layers
    "&kp ASTRSK": "*"
    "&kp ASTERISK": "*"
    "&kp DOLLAR": "$"

  zmk_keycode_map:
    # Enhanced modifiers with icons
    LCTRL: $$mdi:apple-keyboard-control$$
    RCTRL: $$mdi:apple-keyboard-control$$
    LALT: $$mdi:apple-keyboard-option$$
    RALT: $$mdi:apple-keyboard-option$$
    LSHIFT: $$mdi:apple-keyboard-shift$$
    RSHIFT: $$mdi:apple-keyboard-shift$$
    LSHFT: $$mdi:apple-keyboard-shift$$
    RSHFT: $$mdi:apple-keyboard-shift$$
    LGUI: $$mdi:apple-keyboard-command$$
    RGUI: $$mdi:apple-keyboard-command$$

    # Special modifier combinations
    LS(LC(LALT)): $$mdi:triangle$$ # Meh key
    LG(LS(LC(LALT))): $$mdi:star-four-points$$ # Hyper key
    HYP: $$mdi:star-four-points$$ # Hyper key alias

    # Custom application and system keys
    GLOBE: $$mdi:web$$
    APP_EXPOSE: $$mdi:view-grid$$
    MISSION_CTL: $$mdi:view-dashboard$$
    APP_SWITCH: $$mdi:layers-outline$$ # Window switcher within app
    "&kp LG(GRAVE)": $$mdi:layers-outline$$ # Cmd+` for app window switching
    "LG(GRAVE)": $$mdi:layers-outline$$ # Raw key combination
    SMART_PAD: $$mdi:gesture-tap$$
    MAGIC_SHIFT: $$mdi:auto-fix$$
    KEY_REPEAT: $$mdi:repeat$$
    "&kp K_CANCEL": $$mdi:close-circle$$
    XXX: $$mdi:cancel$$ # For disabled keys

    # Scrolling keys
    SCROLL_UP: $$mdi:arrow-down-circle$$
    SCROLL_DN: $$mdi:arrow-up-circle$$
    SCRL_UP: $$mdi:arrow-down-circle$$

    # Mouse controls - homerow layout: left, down, up, right
    U_MS_U: $$mdi:arrow-up-bold-circle$$
    U_MS_D: $$mdi:arrow-down-bold-circle$$
    U_MS_L: $$mdi:arrow-left-bold-circle$$
    U_MS_R: $$mdi:arrow-right-bold-circle$$
    U_WH_U: $$mdi:mouse-move-up$$
    U_WH_D: $$mdi:mouse-move-down$$

    # Joystick/directional controls
    J_UP: $$mdi:arrow-up$$
    J_DW: $$mdi:arrow-down$$
    J_LF: $$mdi:arrow-left$$
    J_RH: $$mdi:arrow-right$$
    J_CT: $$mdi:circle-medium$$

    # Numpad keys - cleaner display
    KP_N0: "0"
    KP_N1: "1"
    KP_N2: "2"
    KP_N3: "3"
    KP_N4: "4"
    KP_N5: "5"
    KP_N6: "6"
    KP_N7: "7"
    KP_N8: "8"
    KP_N9: "9"
    KP_DOT: "."
    KP_PLUS: "+"
    KP_MINUS: "-"
    KP_MULTIPLY: "Ã—"
    KP_DIVIDE: "Ã·"
    KP_EQUAL: "="
    KP_ENTER: $$mdi:keyboard-return$$
    KP_COMMA: ","

    # Alternative: Visual numpad with badges (uncomment to use)
    # KP_N0: $$mdi:numeric-0-circle$$
    # KP_N1: $$mdi:numeric-1-circle$$
    # KP_N2: $$mdi:numeric-2-circle$$
    # KP_N3: $$mdi:numeric-3-circle$$
    # KP_N4: $$mdi:numeric-4-circle$$
    # KP_N5: $$mdi:numeric-5-circle$$
    # KP_N6: $$mdi:numeric-6-circle$$
    # KP_N7: $$mdi:numeric-7-circle$$
    # KP_N8: $$mdi:numeric-8-circle$$
    # KP_N9: $$mdi:numeric-9-circle$$

    # Alternative: Icon-based math operations (uncomment to use)
    # KP_PLUS: $$mdi:plus$$
    # KP_MINUS: $$mdi:minus$$
    # KP_MULTIPLY: $$mdi:close$$
    # KP_DIVIDE: $$mdi:division$$
    # KP_EQUAL: $$mdi:equal$$

    # Function keys with keyboard icons
    F1: $$mdi:keyboard-f1$$
    F2: $$mdi:keyboard-f2$$
    F3: $$mdi:keyboard-f3$$
    F4: $$mdi:keyboard-f4$$
    F5: $$mdi:keyboard-f5$$
    F6: $$mdi:keyboard-f6$$
    F7: $$mdi:keyboard-f7$$
    F8: $$mdi:keyboard-f8$$
    F9: $$mdi:keyboard-f9$$
    F10: $$mdi:keyboard-f10$$
    F11: $$mdi:keyboard-f11$$
    F12: $$mdi:keyboard-f12$$

    # Layer names for better visualization
    DEF: $$mdi:keyboard$$
    NAV: $$mdi:navigation$$
    NUM: $$mdi:numeric$$
    FN: $$mdi:function$$
    SYS: $$mdi:cog$$
    MCR: $$mdi:macro$$
    MIC: $$mdi:mouse$$
    PAD: $$mdi:gamepad$$

    # Navigation arrows
    UP: $$mdi:arrow-up-bold$$
    DOWN: $$mdi:arrow-down-bold$$
    LEFT: $$mdi:arrow-left-bold$$
    RIGHT: $$mdi:arrow-right-bold$$
    PG_UP: $$mdi:transfer-up$$
    PG_DN: $$mdi:transfer-down$$
    HOME: $$mdi:format-horizontal-align-left$$
    END: $$mdi:format-horizontal-align-right$$

    # Enhanced symbol keys with shift combinations
    MINUS:
      tap: "-"
      shifted: "_"
    EQUAL:
      tap: "="
      shifted: "+"
    SLASH:
      tap: "/"
      shifted: "?"
    BACKSLASH:
      tap: '\'
      shifted: "|"
    SEMICOLON:
      tap: ";"
      shifted: ":"
    SINGLE_QUOTE:
      tap: "'"
      shifted: '"'
    COMMA:
      tap: ","
      shifted: "<"
    DOT:
      tap: "."
      shifted: ">"
    LEFT_BRACKET:
      tap: "["
      shifted: "{"
    RIGHT_BRACKET:
      tap: "]"
      shifted: "}"
    GRAVE:
      tap: "`"
      shifted: "~"
      
    # Fix for LG(GRAVE) combination display  
    LGUI_GRAVE: $$mdi:layers-outline$$
    GUI_GRAVE: $$mdi:layers-outline$$

    # Number keys with symbols
    N1:
      tap: "1"
      shifted: "!"
    N2:
      tap: "2"
      shifted: "@"
    N3:
      tap: "3"
      shifted: "#"
    N4:
      tap: "4"
      shifted: "$"
    N5:
      tap: "5"
      shifted: "%"
    N6:
      tap: "6"
      shifted: "^"
    N7:
      tap: "7"
      shifted: "&"
    N8:
      tap: "8"
      shifted: "*"
    N9:
      tap: "9"
      shifted: "("
    N0:
      tap: "0"
      shifted: ")"

    # Special keys with icons
    ENTER:
      type: enter
      tap: $$mdi:keyboard-return$$
    ESC: $$mdi:keyboard-esc$$
    TAB: $$mdi:keyboard-tab$$
    LS(TAB): $$mdi:keyboard-tab-reverse$$
    SPACE: $$mdi:keyboard-space$$
    BACKSPACE:
      type: backspace
      tap: $$mdi:backspace$$
    BSPC:
      type: backspace
      tap: $$mdi:backspace$$
    DELETE: $$mdi:backspace-reverse-outline$$
    DEL: $$mdi:backspace-reverse-outline$$

    # Locks
    CAPSLOCK: $$mdi:apple-keyboard-caps$$
    CAPS: $$mdi:apple-keyboard-caps$$

    # Media and system
    C_MUTE: $$mdi:volume-off$$
    C_VOL_UP: $$mdi:volume-high$$
    C_VOL_DN: $$mdi:volume-low$$
    C_NEXT: $$mdi:skip-next$$
    C_PREV: $$mdi:skip-previous$$
    C_PP: $$mdi:play-pause$$
    C_POWER: $$mdi:power-standby$$
    C_BRI_UP: $$mdi:brightness-5$$
    C_BRI_DN: $$mdi:brightness-7$$

  zmk_combos:
    # Position combos with better alignment
    combo_esc:
      align: top
      offset: 0.1
      draw_separate: true
    combo_tab:
      align: bottom
      offset: 0.1
      draw_separate: true
    l_tab:
      tap: $$mdi:keyboard-tab$$
      draw_separate: true
    r_tab:
      tap: $$mdi:keyboard-tab-reverse$$
      draw_separate: true
    combo_enter:
      align: right
      offset: 0.1
      draw_separate: true
    combo_bt_clear:
      align: top
      offset: 0.03
      draw_separate: true

draw_config:
  # Key dimensions
  key_h: 60
  key_rx: 6
  key_ry: 6

  # Combo styling
  combo_w: 28
  combo_h: 26

  # Spacing - tighter margins for better centering
  inner_pad_w: 2
  inner_pad_h: 1
  outer_pad_w: 30
  outer_pad_h: 56

  # Text styling - very tight spacing for center alignment
  line_spacing: 0.6
  shrink_wide_legends: 7
  append_colon_to_layer_header: false

  # Glyph sizes - main icons normal, numbers smaller
  glyph_tap_size: 14
  glyph_hold_size: 8
  glyph_shifted_size: 8

  # Clean, modern styling inspired by the example
  svg_style: |
    /* inherit to force styles through use tags */
    svg path {
        fill: inherit;
    }

    /* font and background color specifications */
    svg.keymap {
        /* Color palette */
        --color-bg: #fafaf9;
        --color-text: #37474f;

        /* Base key colors */
        --color-key-bg: #ffffff;
        --color-key-border: #e0e0e0;
        --color-key-text: #37474f;
        --color-key-secondary: #78909c;

        /* Base/Default layer */
        --color-base-bg: #f8f9fa;
        --color-base-border: #dee2e6;
        --color-base-text: #37474f;

        /* Navigation layer */
        --color-nav-bg: #e8f5e8;
        --color-nav-border: #c8e6c9;
        --color-nav-text: #2e7d32;

        /* Function layer */
        --color-fn-bg: #fff3e0;
        --color-fn-border: #ffcc80;
        --color-fn-text: #e65100;

        /* Number layer */
        --color-num-bg: #f3e5f5;
        --color-num-border: #ce93d8;
        --color-num-text: #7b1fa2;

        /* System layer */
        --color-sys-bg: #e0f2f1;
        --color-sys-border: #80cbc4;
        --color-sys-text: #00695c;

        /* Macro layer */
        --color-macro-bg: #ffebee;
        --color-macro-border: #ffcdd2;
        --color-macro-text: #c62828;

        /* Mouse layer */
        --color-mouse-bg: #fce4ec;
        --color-mouse-border: #f8bbd9;
        --color-mouse-text: #880e4f;

        /* Pad layer */
        --color-pad-bg: #f1f8e9;
        --color-pad-border: #c5e1a5;
        --color-pad-text: #33691e;

    /* Inactive/Transparent key styling */
    --color-trans-bg: #f5f5f4;
    --color-trans-border: #e7e5e4;
    --color-trans-text: #d6d3d1;
    --trans-opacity: 1;

        /* Thumb key colors per layer - for active state indication */
        --color-thumb-base-bg: var(--color-base-bg);
        --color-thumb-base-border: var(--color-base-border);
        --color-thumb-nav-bg: var(--color-nav-bg);
        --color-thumb-nav-border: var(--color-nav-border);
        --color-thumb-fn-bg: var(--color-fn-bg);
        --color-thumb-fn-border: var(--color-fn-border);
        --color-thumb-num-bg: var(--color-num-bg);
        --color-thumb-num-border: var(--color-num-border);
        --color-thumb-sys-bg: var(--color-sys-bg);
        --color-thumb-sys-border: var(--color-sys-border);
        --color-thumb-macro-bg: var(--color-macro-bg);
        --color-thumb-macro-border: var(--color-macro-border);
        --color-thumb-mouse-bg: var(--color-mouse-bg);
        --color-thumb-mouse-border: var(--color-mouse-border);
        --color-thumb-pad-bg: var(--color-pad-bg);
        --color-thumb-pad-border: var(--color-pad-border);

        /* Enhanced thumb highlighting - brighter colors for active states */
        --color-thumb-active-bg: #4caf50;
        --color-thumb-active-border: #388e3c;
        --color-thumb-active-text: #ffffff;

        /* Modifier keys */
        --color-mod-bg: #e3f2fd;
        --color-mod-border: #bbdefb;

        /* Combo colors */
        --color-combo-bg: #e7e5e4;
        --color-combo-border: #57534d
        --color-combo-text: #57534d;

        /* Keys underneath combos - separate from regular base keys */
        --color-combo-key-bg: #f5f5f4;
        --color-combo-key-border: #e7e5e4;

        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'SF Pro Display', sans-serif;
        font-size: 20px;
        font-weight: 600;
        font-kerning: normal;
        text-rendering: optimizeLegibility;
        background-color: var(--color-bg);
        fill: var(--color-text);
    }

    /* Default key styling */
    rect.key {
      fill: var(--color-key-bg);
      stroke: var(--color-key-border);
      stroke-width: 1;
      shape-rendering: geometricPrecision;
    }

    /* Text positioning and styling */
    text {
        text-anchor: middle;
        dominant-baseline: middle;
        line-height: 1;
    }

    .tap {
      fill: var(--color-key-text);
    }

    .hold {
      fill: var(--color-key-secondary);
      font-size: 10px;
      text-anchor: middle;
      dominant-baseline: hanging;
      transform: translateY(-8px);
    }

    .shifted {
      fill: var(--color-key-secondary);
      font-size: 16px;
      text-anchor: middle;
      dominant-baseline: hanging;
    }

    /* Layer-specific styling */
    .layer-Nav rect.key {
      fill: var(--color-nav-bg);
      stroke: var(--color-nav-border);
    }

    .layer-Nav .tap {
      fill: var(--color-nav-text);
    }

    .layer-Fn rect.key {
      fill: var(--color-fn-bg);
      stroke: var(--color-fn-border);
    }

    .layer-Fn .tap {
      fill: var(--color-fn-text);
    }

    .layer-Num rect.key {
      fill: var(--color-num-bg);
      stroke: var(--color-num-border);
    }

    .layer-Num .tap {
      fill: var(--color-num-text);
    }

    .layer-Macro rect.key {
      fill: var(--color-macro-bg);
      stroke: var(--color-macro-border);
    }

    .layer-Macro .tap {
      fill: var(--color-macro-text);
    }

    .layer-Sys rect.key {
      fill: var(--color-sys-bg);
      stroke: var(--color-sys-border);
    }

    .layer-Sys .tap {
      fill: var(--color-sys-text);
    }

    .layer-Mouse rect.key {
      fill: var(--color-mouse-bg);
      stroke: var(--color-mouse-border);
    }

    .layer-Mouse .tap {
      fill: var(--color-mouse-text);
    }

    .layer-Pad rect.key {
      fill: var(--color-pad-bg);
      stroke: var(--color-pad-border);
    }

    .layer-Pad .tap {
      fill: var(--color-pad-text);
    }

    /* Combos layer - keys underneath combo overlays */
    .layer-Combos rect.key {
      fill: var(--color-combo-key-bg);
      stroke: var(--color-combo-key-border);
    }

    .layer-Combos .tap {
      fill: var(--color-key-text);
    }

    /* Thumb key styling per layer - for indicating active layer */
    .thumb-base rect.key {
      fill: var(--color-thumb-base-bg);
      stroke: var(--color-thumb-base-border);
    }

    .thumb-nav rect.key {
      fill: var(--color-thumb-nav-bg);
      stroke: var(--color-thumb-nav-border);
    }

    .thumb-fn rect.key {
      fill: var(--color-thumb-fn-bg);
      stroke: var(--color-thumb-fn-border);
    }

    .thumb-num rect.key {
      fill: var(--color-thumb-num-bg);
      stroke: var(--color-thumb-num-border);
    }

    .thumb-sys rect.key {
      fill: var(--color-thumb-sys-bg);
      stroke: var(--color-thumb-sys-border);
    }

    .thumb-macro rect.key {
      fill: var(--color-thumb-macro-bg);
      stroke: var(--color-thumb-macro-border);
    }

    .thumb-mouse rect.key {
      fill: var(--color-thumb-mouse-bg);
      stroke: var(--color-thumb-mouse-border);
    }

    .thumb-pad rect.key {
      fill: var(--color-thumb-pad-bg);
      stroke: var(--color-thumb-pad-border);
    }

    /* Active thumb key highlighting - use when layer is active */
    .thumb-active rect.key {
      fill: var(--color-thumb-active-bg);
      stroke: var(--color-thumb-active-border);
      stroke-width: 2;
      box-shadow: 0 0 6px rgba(76, 175, 80, 0.5);
    }

    .thumb-active .tap {
      fill: var(--color-thumb-active-text);
      font-weight: 700;
    }

    /* Home row modifier styling */
    .held rect.key {
      fill: var(--color-mod-bg);
      stroke: var(--color-mod-border);
    }

    /* Combo styling */
    rect.combo {
      fill: var(--color-combo-bg);
      stroke: var(--color-combo-border);
      stroke-width: 1;
      opacity: 0.8;
    }

    path.combo {
      stroke: #d6d3d1;
      stroke-width: 1;
      fill: none;
      opacity: 1;
    }

    .combo .tap {
      fill: var(--color-combo-text);
      font-size: 16px;
    }

     .combo .shifted,
     .combo .hold {
       font-size: 13px;
     }

    /* Keys underneath combos - distinct from regular base keys */
    .combo-key rect.key {
      fill: var(--color-combo-key-bg);
      stroke: var(--color-combo-key-border);
    }

    /* Special key types */
    .trans rect.key {
      fill: var(--color-trans-bg);
      stroke: var(--color-trans-border);
      opacity: var(--trans-opacity);
    }

    .trans .tap {
      fill: var(--color-trans-text);
    }

    .trans .hold,
    .trans .shifted {
      fill: var(--color-trans-text);
    }

    .ghost rect.key {
      opacity: 0.4;
      stroke-dasharray: 2,2;
    }

    /* Layer labels */
    text.label {
      font-size: 36px;
      font-weight: 600;
      fill: var(--color-text);
      text-anchor: start;
      paint-order: stroke;
    }

    /* Glyph styling */
    .glyph {
      opacity: 0.9;
    }

    /* Bootloader and reset keys */
    .bootloader rect.key {
      fill: var(--color-sys-bg);
      stroke: var(--color-sys-border);
    }

    /* Enter and backspace key types */
    .enter rect.key,
    .backspace rect.key {
      fill: var(--color-base-bg);
      stroke: var(--color-base-border);
    }
